SELECT * FROM (SELECT DISTINCT (p.sequence_no), s.description, 'notinhold' AS flag, s.priority FROM (SELECT DISTINCT (sequence_no) FROM production_tracker WHERE stage_completed_by IS NOT NULL AND sequence_no IN (SELECT DISTINCT sequence_no FROM production_tracker WHERE (work_center_id = '11' AND stage_completed_by IS NOT NULL)) AND sequence_no NOT IN (SELECT DISTINCT sequence_no FROM production_tracker WHERE (work_center_id = '12')) AND sequence_no NOT IN (SELECT DISTINCT sequence_no FROM production_tracker WHERE (work_center_id = '13')) AND sequence_no NOT IN (SELECT DISTINCT sequence_no FROM production_tracker_hold WHERE (unhold_dt IS NULL AND work_center_id = '12')) AND sequence_no NOT IN (SELECT DISTINCT sequence_no FROM production_tracker_rework WHERE (rework_complete IS NULL)) AND sequence_no NOT IN (SELECT DISTINCT sequence_no FROM production_tracker_building_18_rework WHERE (rework_complete IS NULL)) AND sequence_no IN (SELECT DISTINCT sequence_no FROM sequence_nos WHERE (is_active = 'Y'))) p LEFT JOIN sequence_nos s ON (p.sequence_no = s.sequence_no) UNION SELECT DISTINCT (p.sequence_no), s.description, 'hold' AS flag, s.priority FROM (SELECT DISTINCT (sequence_no) FROM production_tracker WHERE stage_completed_by IS NOT NULL AND sequence_no IN (SELECT DISTINCT sequence_no FROM production_tracker WHERE (work_center_id = '11' AND stage_completed_by IS NOT NULL)) AND sequence_no NOT IN (SELECT DISTINCT sequence_no FROM production_tracker WHERE (work_center_id = '12')) AND sequence_no NOT IN (SELECT DISTINCT sequence_no FROM production_tracker WHERE (work_center_id = '13')) AND sequence_no IN (SELECT DISTINCT sequence_no FROM production_tracker_hold WHERE (unhold_dt IS NULL AND work_center_id = '12')) AND sequence_no NOT IN (SELECT DISTINCT sequence_no FROM production_tracker_rework WHERE (rework_complete IS NULL)) AND sequence_no NOT IN (SELECT DISTINCT sequence_no FROM production_tracker_building_18_rework WHERE (rework_complete IS NULL)) AND sequence_no IN (SELECT DISTINCT sequence_no FROM sequence_nos WHERE (is_active = 'Y'))) p LEFT JOIN sequence_nos s ON (p.sequence_no = s.sequence_no production_tracker ORDER BY priority , sequence_no